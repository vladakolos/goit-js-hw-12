{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios, { Axios } from 'axios';\n\nconst API_KEY = '43840799-e71ea23b4db8ae9f9c01a8841';\nconst BASE_URL = 'https://pixabay.com/api/';\naxios.defaults.baseURL = BASE_URL;\n\nexport const fetchImages = (query, page = 1) => {\n  const searchParams = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 15,\n  };\n  return axios.get('?', { params: { ...searchParams } });\n};\n","export const renderTemplate = data => {\n  return `\n    <a href=\"${data.largeImageURL}\" class=\"item\">\n      <img src=\"${data.webformatURL}\" alt=\"\" alt=\"${data.tags}\"/>\n      <div class=\"data\">\n        <p><b>Likes</b> <span>${data.likes}</span></p>\n        <p><b>Views</b> <span>${data.views}</span></p>\n        <p><b>Comments</b> <span>${data.comments}</span></p>\n        <p><b>Downloads</b> <span>${data.downloads}</span></p>\n      </div>\n    </a>\n  `;\n};\n","import { fetchImages } from './js/pixabay-api.js';\nimport { renderTemplate } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst formEl = document.querySelector('form.form-search');\nconst galleryEl = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.loadMore');\nconst lightbox = new SimpleLightbox('.gallery a', {});\n\nlet page = 1;\n// let totalPages = 1;\n// let totalHits = 0;\nlet rememberLastValue;\n\nconst perPage = 15;\n\nconst requestImages = async (searchQuery, isFirstLoad = true) => {\n  try {\n    if (isFirstLoad) {\n      page = 1;\n      // totalPages = 1;\n      galleryEl.innerHTML = '';\n      loaderEl.classList.remove('is-hidden');\n    }\n\n    // if (page > totalPages) {\n    //   iziToast.info({\n    //     message: 'No more images to load.',\n    //     position: 'topRight',\n    //     class: 'info',\n    //     color: 'white',\n    //   });\n    //   return;\n    // }\n\n    const data = await fetchImages(searchQuery, page);\n\n    if (data.data.total === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        class: 'error',\n        color: 'white',\n      });\n      loadMoreBtnEl.classList.add('d-none');\n      loaderEl.classList.add('is-hidden');\n      return;\n    }\n\n    // totalHits = data.data.totalHits;\n    // totalPages = Math.ceil(totalHits / perPage);\n    page++;\n\n    const imagesHtml = data.data.hits\n      .map(image => renderTemplate(image))\n      .join('');\n\n    if (isFirstLoad) {\n      galleryEl.innerHTML = imagesHtml;\n    } else {\n      galleryEl.insertAdjacentHTML('beforeend', imagesHtml);\n\n      const { height: cardHeight } =\n        galleryEl.firstElementChild.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n\n    lightbox.refresh();\n\n    if (data.data.hits.length < perPage) {\n      iziToast.info({\n        message: 'We`re sorry, but you`ve reached the end of search results.',\n        position: 'topRight',\n        class: 'info',\n        color: 'white',\n      });\n      loadMoreBtnEl.classList.add('d-none');\n    } else {\n      loadMoreBtnEl.classList.remove('d-none');\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    iziToast.error({\n      message: 'Error fetching images. Please try again later.',\n      position: 'topRight',\n      class: 'error',\n      color: 'white',\n    });\n    loadMoreBtnEl.classList.add('d-none');\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n};\n\nif (formEl) {\n  formEl.addEventListener('submit', async event => {\n    event.preventDefault();\n    const inputValue = formEl.elements.search.value.trim();\n\n    if (!inputValue) {\n      iziToast.error({\n        message: 'Please enter a search term',\n        position: 'topRight',\n        class: 'error',\n        color: 'white',\n      });\n      loadMoreBtnEl.classList.add('d-none');\n      return;\n    }\n\n    rememberLastValue = inputValue;\n    await requestImages(inputValue);\n    formEl.reset();\n  });\n}\n\nif (loadMoreBtnEl) {\n  loadMoreBtnEl.addEventListener('click', async () => {\n    loadMoreBtnEl.classList.add('d-none');\n    loaderEl.classList.remove('is-hidden');\n    await requestImages(rememberLastValue, false);\n    loaderEl.classList.add('is-hidden');\n  });\n}\n"],"names":["API_KEY","BASE_URL","axios","fetchImages","query","page","searchParams","renderTemplate","data","formEl","galleryEl","loaderEl","loadMoreBtnEl","lightbox","SimpleLightbox","rememberLastValue","perPage","requestImages","searchQuery","isFirstLoad","iziToast","imagesHtml","image","cardHeight","error","event","inputValue"],"mappings":"owBAEA,MAAMA,EAAU,qCACVC,EAAW,2BACjBC,EAAM,SAAS,QAAUD,EAElB,MAAME,EAAc,CAACC,EAAOC,EAAO,IAAM,CAC9C,MAAMC,EAAe,CACnB,IAAKN,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EACd,EACE,OAAOH,EAAM,IAAI,IAAK,CAAE,OAAQ,CAAE,GAAGI,CAAc,CAAA,CAAE,CACvD,ECjBaC,EAAiBC,GACrB;AAAA,eACMA,EAAK,aAAa;AAAA,kBACfA,EAAK,YAAY,iBAAiBA,EAAK,IAAI;AAAA;AAAA,gCAE7BA,EAAK,KAAK;AAAA,gCACVA,EAAK,KAAK;AAAA,mCACPA,EAAK,QAAQ;AAAA,oCACZA,EAAK,SAAS;AAAA;AAAA;AAAA,ICD5CC,EAAS,SAAS,cAAc,kBAAkB,EAClDC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAW,SAAS,cAAc,SAAS,EAC3CC,EAAgB,SAAS,cAAc,WAAW,EAClDC,EAAW,IAAIC,EAAe,aAAc,CAAE,CAAA,EAEpD,IAAIT,EAAO,EAGPU,EAEJ,MAAMC,EAAU,GAEVC,EAAgB,MAAOC,EAAaC,EAAc,KAAS,CAC/D,GAAI,CACEA,IACFd,EAAO,EAEPK,EAAU,UAAY,GACtBC,EAAS,UAAU,OAAO,WAAW,GAavC,MAAMH,EAAO,MAAML,EAAYe,EAAab,CAAI,EAEhD,GAAIG,EAAK,KAAK,QAAU,EAAG,CACzBY,EAAS,MAAM,CACb,QACE,2EACF,SAAU,WACV,MAAO,QACP,MAAO,OACf,CAAO,EACDR,EAAc,UAAU,IAAI,QAAQ,EACpCD,EAAS,UAAU,IAAI,WAAW,EAClC,MACD,CAIDN,IAEA,MAAMgB,EAAab,EAAK,KAAK,KAC1B,IAAIc,GAASf,EAAee,CAAK,CAAC,EAClC,KAAK,EAAE,EAEV,GAAIH,EACFT,EAAU,UAAYW,MACjB,CACLX,EAAU,mBAAmB,YAAaW,CAAU,EAEpD,KAAM,CAAE,OAAQE,CAAY,EAC1Bb,EAAU,kBAAkB,wBAC9B,OAAO,SAAS,CACd,IAAKa,EAAa,EAClB,SAAU,QAClB,CAAO,CACF,CAEDV,EAAS,QAAO,EAEZL,EAAK,KAAK,KAAK,OAASQ,GAC1BI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,MAAO,OACP,MAAO,OACf,CAAO,EACDR,EAAc,UAAU,IAAI,QAAQ,GAEpCA,EAAc,UAAU,OAAO,QAAQ,CAE1C,OAAQY,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,EAC7CJ,EAAS,MAAM,CACb,QAAS,iDACT,SAAU,WACV,MAAO,QACP,MAAO,OACb,CAAK,EACDR,EAAc,UAAU,IAAI,QAAQ,CACxC,QAAY,CACRD,EAAS,UAAU,IAAI,WAAW,CACnC,CACH,EAEIF,GACFA,EAAO,iBAAiB,SAAU,MAAMgB,GAAS,CAC/CA,EAAM,eAAc,EACpB,MAAMC,EAAajB,EAAO,SAAS,OAAO,MAAM,OAEhD,GAAI,CAACiB,EAAY,CACfN,EAAS,MAAM,CACb,QAAS,6BACT,SAAU,WACV,MAAO,QACP,MAAO,OACf,CAAO,EACDR,EAAc,UAAU,IAAI,QAAQ,EACpC,MACD,CAEDG,EAAoBW,EACpB,MAAMT,EAAcS,CAAU,EAC9BjB,EAAO,MAAK,CAChB,CAAG,EAGCG,GACFA,EAAc,iBAAiB,QAAS,SAAY,CAClDA,EAAc,UAAU,IAAI,QAAQ,EACpCD,EAAS,UAAU,OAAO,WAAW,EACrC,MAAMM,EAAcF,EAAmB,EAAK,EAC5CJ,EAAS,UAAU,IAAI,WAAW,CACtC,CAAG"}